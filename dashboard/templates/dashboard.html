{% extends "layout.html" %}

{% block search %}
  <div class="mui-form--inline filter">
    <img src="/static/img/search.svg">
    <div class="mui-textfield">
      <label for="filter" class="visually-hidden">Search for an app by name</label>
      <input type="text" name="filter" id="filter" placeholder="Search for an app by name" autocomplete="off">
      <svg class="clear" width="26px" height="26px" viewBox="0 0 26 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <defs></defs>
        <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g id="icons-/-clear" fill="#000000">
            <polygon id="ion-ios-plus-empty---Ionicons" transform="translate(13.000000, 13.000000) rotate(45.000000) translate(-13.000000, -13.000000) " points="22 13.6328125 13.5625 13.6328125 13.5625 22 12.3671875 22 12.3671875 13.6328125 4 13.6328125 4 12.4375 12.3671875 12.4375 12.3671875 4 13.5625 4 13.5625 12.4375 22 12.4375"></polygon>
          </g>
        </g>
      </svg>
    </div>
  </div>
{% endblock %}

{% block search_button %}
  <div class="search-button">
    <button type="button"><span class="visually-hidden">Toggle search field</span></button>
  </div>
{% endblock %}

{% block search_mobile %}
  <div class="search-mobile">
    <div class="mui-textfield">
      <label for="filter2" class="visually-hidden">Search for an app by name</label>
      <input type="text" name="filter2" id="filter2" placeholder="Search for an app by name">
    </div>
  </div>
{% endblock %}

{% block menu %}
  <div class="menu">
    <button type="button" class="menu-toggle"><span class="visually-hidden">Toggle user options</span></button>
    {% with avatar = user.avatar, name = user.first_name %}
      {% if user.alerts.get('visible_alerts', [])|length > 0 %}
        <span class="alerts-count"><span class="visually-hidden">You have {{ user.alerts['visible_alerts']|count }} unread alerts</span></span>
      {% endif %}
      <span class="name">{% if name %}{{ name }}{% endif %}</span>
      {% if avatar %}
        <img class="profile-icon" src="{{ avatar }}">
      {% else %}
        <svg class="default-avatar" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="icons-/-user-black" fill="#000000">
              <g id="icons/user">
                <path d="M10,1.5 C9.46614316,1.5 8.93880469,1.60091045 8.41796875,1.80273438 C7.89713281,2.0045583 7.4283875,2.26171719 7.01171875,2.57421875 C6.59505,2.88672031 6.25976689,3.22525859 6.00585938,3.58984375 C5.75195186,3.95442891 5.625,4.29947754 5.625,4.625 L5.625,7.75 C5.625,8.36198223 5.77799326,9.14322441 6.08398438,10.09375 C6.38997549,11.0442756 6.86848633,11.7799453 7.51953125,12.3007812 C7.68880293,12.4309902 7.81575479,12.5970042 7.90039062,12.7988281 C7.98502646,13.0006521 8.01432305,13.2122385 7.98828125,13.4335938 C7.94921855,13.6419281 7.86783916,13.8339835 7.74414062,14.0097656 C7.62044209,14.1855478 7.46093848,14.31901 7.265625,14.4101562 L1.77734375,17.0078125 C1.69921836,17.0338543 1.59179756,17.0957026 1.45507812,17.1933594 C1.31835869,17.2910161 1.25,17.4700508 1.25,17.7304688 L1.25,19 L18.7304688,18.9804688 L18.7304688,17.7695312 C18.7304688,17.4309879 18.6490894,17.2194015 18.4863281,17.1347656 C18.3235669,17.0501298 18.2356771,17.0078125 18.2226562,17.0078125 L12.7734375,14.4296875 C12.578124,14.3385412 12.4153652,14.205079 12.2851562,14.0292969 C12.1549473,13.8535147 12.076823,13.654949 12.0507812,13.4335938 C12.0247395,13.2122385 12.054036,13.0006521 12.1386719,12.7988281 C12.2233077,12.5970042 12.3502596,12.4309902 12.5195312,12.3007812 C13.196618,11.7799453 13.6751288,11.0410204 13.9550781,10.0839844 C14.2350274,9.12694834 14.375,8.34896133 14.375,7.75 L14.375,4.625 C14.375,4.28645664 14.244793,3.93489766 13.984375,3.5703125 C13.723957,3.20572734 13.3886739,2.87044424 12.9785156,2.56445312 C12.5683573,2.25846201 12.099612,2.0045583 11.5722656,1.80273438 C11.0449192,1.60091045 10.5208359,1.5 10,1.5 Z M10,0.25 C10.6901076,0.25 11.3704394,0.380207031 12.0410156,0.640625 C12.7115919,0.901042969 13.3105442,1.23958125 13.8378906,1.65625 C14.365237,2.07291875 14.7949202,2.54166406 15.1269531,3.0625 C15.458986,3.58333594 15.625,4.10416406 15.625,4.625 L15.625,7.75 C15.625,8.12760605 15.5859379,8.56379961 15.5078125,9.05859375 C15.4296871,9.55338789 15.2994801,10.0579401 15.1171875,10.5722656 C14.9348949,11.0865911 14.6940119,11.5813778 14.3945312,12.0566406 C14.0950506,12.5319034 13.7304709,12.9388004 13.3007812,13.2773438 L18.75,15.875 L19.3652344,16.2167969 C19.7753927,16.4446626 19.9804688,16.7408836 19.9804688,17.1054688 L19.9804688,19 C19.9804688,19.3385434 19.8600272,19.628254 19.6191406,19.8691406 C19.378254,20.1100272 19.0885434,20.2304688 18.75,20.2304688 L1.25,20.2304688 C0.898435742,20.2304688 0.602214746,20.1100272 0.361328125,19.8691406 C0.120441504,19.628254 0,19.3385434 0,19 L0,17.1054688 C0,16.7669254 0.20833125,16.4772147 0.625,16.2363281 L1.25,15.875 L6.73828125,13.2773438 C6.2955707,12.9257795 5.92448066,12.5026066 5.625,12.0078125 C5.32551934,11.5130184 5.08138115,11.0084661 4.89257812,10.4941406 C4.7037751,9.97981514 4.57031289,9.47851807 4.4921875,8.99023438 C4.41406211,8.50195068 4.375,8.08854336 4.375,7.75 L4.375,4.625 C4.375,4.10416406 4.53775879,3.58333594 4.86328125,3.0625 C5.18880371,2.54166406 5.61523174,2.07291875 6.14257812,1.65625 C6.66992451,1.23958125 7.27213203,0.901042969 7.94921875,0.640625 C8.62630547,0.380207031 9.30989238,0.25 10,0.25 Z" id="User---simple-line-icons"></path>
              </g>
            </g>
          </g>
        </svg>
      {% endif %}
    {% endwith %}
  </div>
{% endblock %}

{% block user_menu %}
  <div class="user-menu">
    <a href="https://people.mozilla.org/e" target="_blank"><span>Settings</span> <img class="menu-icon" src="/static/img/settings.svg" alt=""></a>
    <a {% if user.alerts %}href="/notifications"{% else %}href="#" class="inactive"{% endif %}><span>Notifications</span> <img class="menu-icon" src="/static/img/alerts/notification-white.svg" alt=""></a>
    <a href="/logout"><span>Logout</span> <img class="menu-icon"src="/static/img/logout.svg" alt=""></a>
    <a href="/autologin-settings"><span>Enable / Disable Auto-login</span></a>
    <div class="coming-soon"><span>coming soon</span></div>
    <a href="#" class="inactive"><span>Access Request</span> <img class="menu-icon"src="/static/img/request.svg" alt=""></a>
  </div>
{% endblock %}

{% block messages %}
  <div class="messages">
    <div class="alert alert-low" id="alert-nightly">
      <div class="alert-risk"><span>low risk</span></div>
      <p>Want to help test Firefox? Give Firefox Beta a try!</p>
      <div class="alert-actions">
        <a href="https://beta.mozilla.org/" class="btn-alert" target="_blank">
          {% include 'icons/alert.svg' %}
          <span class="info-text">Download</span>
        </a>
        <button type="button" data-process-action="acknowledge" class="closebtn"><span aria-hidden="true">&times;</span><span class="visually-hidden">Dismiss</button>
      </div>
    </div>


    {% for alert in user.alerts.get('visible_alerts') %}
      <div class="alert alert-{{ alert.risk }}" id="{{ alert.get('alert_id') }}">
        <div class="alert-risk"><span>{{ alert.risk }} risk</span></div>
        <p>{{ alert.summary }}</p>
        <p class="alert-timing"><time>{{ alert.date }}</time></p>
        <div class="alert-actions">
          <a href="{{ alert.url }}" class="btn-alert" target="_blank">
            {% include 'icons/alert.svg' %}
            {{ alert.url_title }}
          </a>
          {% if alert.get('state') != 'escalate' and alert.get('alert_code') == '416c65727447656f6d6f64656c' %}
            <button type="button" data-process-action="escalate" data-process-action-success="This alert has been escalated to the Mozilla Operations Center." data-process-action-error="An error has occurred, please try again later." class="btn-alert">
              {% include 'icons/arrow-right.svg' %}
              <span class="info-text">Escalate to Security</span>
            </button>
          {% endif %}
          <a href="/notifications" class="btn-alert">
            {% include 'icons/info.svg' %}
            <span class="info-text">More Info</span>
          </a>
        </div>
        <div class="alert-feedback"  role="alert">
          <div class="loading-indicator">{% include 'icons/loading-white.svg' %}</div>
          {% if alert.get('state') == 'escalate' %}
          <p>This alert has been escalated to the Mozilla Operations Center.</p>
          {% endif %}
        </div>
        {% include 'partials/alert-feedback.html' %}
        <button type="button" data-process-action="acknowledge" class="closebtn"><span aria-hidden="true">&times;</span><span class="visually-hidden">Dismiss</button>
      </div>
    {% endfor %}
  </div>
{% endblock %}

{% block content %}
  <div id="app-grid" class="mui-row app-grid">
    <ul>
    {% for app in apps %}
      <li>
        <a href="{{ app['application']['url'] }}" data-id="{{ app['application']['name'] }}" class="app-tile" target="_blank">
          <div class="mui--text-center app-logo">
            <img src="{{ config.CDN }}/images/{{ app['application']['logo'] }}" role="presentation" alt="">
          </div>
          <p class="mui--text-center app-name">{{ app['application']['name'] }}</p>
        </a>
      </li>
    {% endfor %}
    </ul>
  </div>
{% endblock %}

<script>
    $(".delete").restintag(optionsObj, function(data) {
        console.log(data);
    },
    function(error) {
        console.log(error);
    });
</script>
